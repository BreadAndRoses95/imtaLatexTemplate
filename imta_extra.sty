%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% File Name:       imta_extra
%
% Description:     Enables advanced functionalities of the IMT Atlantique
%                  LaTeX Template.
%
% Note:            some functionalities require the Minted Package.
%                  This package further requires:
%                     1. To use the --escape-shell option when compiling 
%                        the document
%                     2. To have Pymentize installed (Having Python installed,
%                        you can simply run the command: pip install Pygments)
%
% Limitations:     /
%
% Errors:          None known
%
% Dependencies:    imta_core
%                  anyfontsize
%                  float
%                  mdframed
%                  minted
%                  titling
%
% Author:          A. Foucault - armand.foucault@telecom-bretagne.eu
% Contributors:    B. Porteboeuf - benoit.porteboeuf@telecom-bretagne.eu
%
% University :     IMT Atlantique, Brest (France)
%
% TeX Environment: TeXLive + pdfLaTeX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Revision List:
% Version    Author   Date         Changes
% 1.0        BP       31.10.2017   Original imta.sty package split into
%                                  imt_core.sty and imta_extra.sty
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\NeedsTeXFormat{LaTeX2e}



%%%%%%%%%% PACKAGES %%%%%%%%%%

% Document geometry management
\RequirePackage{imta_core}

% Fancy code listings
\RequirePackage{minted}

% Arbitrary font size
\RequirePackage{anyfontsize}

% Fancy frames and boxes
\RequirePackage{mdframed}



%%%%%%%%%% COMMANDS %%%%%%%%%%

% \imtaInlinecode
% Typeset inline code
% First parameter is the language of the text to typeset
% Second parameter is the text to typeset
\newcommand{\imtaInlinecode}[2]{%
    \setlength{\fboxsep}{2pt}\colorbox{imtaInlineCodeBackground}{\mintinline{#1}{#2}}%
}



%%%%%%%%%% ENVIRONMENTS %%%%%%%%%%

% imtaCode
% Format a listing of code
% The only argument of this environment is the language of the code to format
% This environment wraps around minted, and is therefore a verbatim environment
\newenvironment{imtaCode}[1]{%
    \VerbatimEnvironment%
    \renewcommand{\theFancyVerbLine}{\ttfamily \textcolor{gray!150}{\normalsize \oldstylenums{\arabic{FancyVerbLine}}}}%
    \vspace{0.5\baselineskip}%
    \begin{mdframed}[backgroundcolor=imtaCodeBackground, innerleftmargin=5pt]%
    \begin{minted}[linenos, breaklines]{#1}%
}{
    \end{minted}%
    \end{mdframed}%
}


% imtaConsole
% Format a console session
\newenvironment{imtaConsole}{%
    \VerbatimEnvironment%
    \vspace{0.5\baselineskip}%
    \begin{mdframed}[backgroundcolor=imtaCodeBackground, innerleftmargin=5pt]%
    \begin{minted}{text}%
}{
    \end{minted}%
    \end{mdframed}%
}
